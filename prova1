* global use, db */
// MongoDB Playground
// Use Ctrl+Space inside a snippet or a string literal to trigger completions.

const database = 'local';
const collection = 'prova';

// The current database to use.
use(database);

// Create a new collection.
db.produtos.insertMany( [
    {"nome": "Produto 1", "preco": 27.85, "quantidade_estoque": 56},
    {"nome": "Produto 2", "preco": 412.19, "quantidade_estoque": 12},
    {"nome": "Produto 3", "preco": 785.36, "quantidade_estoque": 34},
    {"nome": "Produto 4", "preco": 128.57, "quantidade_estoque": 78},
    {"nome": "Produto 5", "preco": 619.42, "quantidade_estoque": 92},
    {"nome": "Produto 6", "preco": 875.94, "quantidade_estoque": 10},
    {"nome": "Produto 7", "preco": 338.12, "quantidade_estoque": 65},
    {"nome": "Produto 8", "preco": 249.81, "quantidade_estoque": 23},
    {"nome": "Produto 9", "preco": 731.67, "quantidade_estoque": 45},
    {"nome": "Produto 10", "preco": 176.25, "quantidade_estoque": 87},
    {"nome": "Produto 11", "preco": 415.36, "quantidade_estoque": 29},
    {"nome": "Produto 12", "preco": 563.28, "quantidade_estoque": 67},
    {"nome": "Produto 13", "preco": 841.06, "quantidade_estoque": 17},
    {"nome": "Produto 14", "preco": 319.47, "quantidade_estoque": 51},
    {"nome": "Produto 15", "preco": 207.89, "quantidade_estoque": 3},
    {"nome": "Produto 16", "preco": 520.74, "quantidade_estoque": 41},
    {"nome": "Produto 17", "preco": 612.85, "quantidade_estoque": 76},
    {"nome": "Produto 18", "preco": 498.91, "quantidade_estoque": 84},
    {"nome": "Produto 19", "preco": 928.14, "quantidade_estoque": 19},
    {"nome": "Produto 20", "preco": 147.32, "quantidade_estoque": 60},
    {"nome": "Produto 21", "preco": 767.39, "quantidade_estoque": 88},
    {"nome": "Produto 22", "preco": 685.62, "quantidade_estoque": 73},
    {"nome": "Produto 23", "preco": 195.57, "quantidade_estoque": 6},
    {"nome": "Produto 24", "preco": 832.15, "quantidade_estoque": 42},
    {"nome": "Produto 25", "preco": 313.28, "quantidade_estoque": 70},
    {"nome": "Produto 26", "preco": 482.39, "quantidade_estoque": 35},
    {"nome": "Produto 27", "preco": 577.48, "quantidade_estoque": 25},
    {"nome": "Produto 28", "preco": 369.87, "quantidade_estoque": 8},
    {"nome": "Produto 29", "preco": 885.72, "quantidade_estoque": 62},
    {"nome": "Produto 30", "preco": 298.41, "quantidade_estoque": 96},
    {"nome": "Produto 31", "preco": 701.93, "quantidade_estoque": 30},
    {"nome": "Produto 32", "preco": 149.58, "quantidade_estoque": 64},
    {"nome": "Produto 33", "preco": 457.26, "quantidade_estoque": 15},
    {"nome": "Produto 34", "preco": 974.85, "quantidade_estoque": 80},
    {"nome": "Produto 35", "preco": 364.09, "quantidade_estoque": 37},
    {"nome": "Produto 36", "preco": 625.34, "quantidade_estoque": 69},
    {"nome": "Produto 37", "preco": 746.15, "quantidade_estoque": 21},
    {"nome": "Produto 38", "preco": 836.25, "quantidade_estoque": 85},
    {"nome": "Produto 39", "preco": 281.47, "quantidade_estoque": 52},
    {"nome": "Produto 40", "preco": 589.68, "quantidade_estoque": 43},
    {"nome": "Produto 41", "preco": 439.92, "quantidade_estoque": 99},
    {"nome": "Produto 42", "preco": 912.34, "quantidade_estoque": 49},
    {"nome": "Produto 43", "preco": 375.12, "quantidade_estoque": 2},
    {"nome": "Produto 44", "preco": 208.76, "quantidade_estoque": 72},
    {"nome": "Produto 45", "preco": 785.49, "quantidade_estoque": 46},
    {"nome": "Produto 46", "preco": 569.83, "quantidade_estoque": 68},
    {"nome": "Produto 47", "preco": 129.57, "quantidade_estoque": 11},
    {"nome": "Produto 48", "preco": 654.29, "quantidade_estoque": 57},
    {"nome": "Produto 49", "preco": 498.74, "quantidade_estoque": 95},
    {"nome": "Produto 50", "preco": 387.21, "quantidade_estoque": 81},
    {"nome": "Produto 51", "preco": 209.84, "quantidade_estoque": 47},
    {"nome": "Produto 52", "preco": 853.67, "quantidade_estoque": 40},
    {"nome": "Produto 53", "preco": 791.24, "quantidade_estoque": 14},
    {"nome": "Produto 54", "preco": 631.85, "quantidade_estoque": 48},
    {"nome": "Produto 55", "preco": 926.14, "quantidade_estoque": 18},
    {"nome": "Produto 56", "preco": 455.63, "quantidade_estoque": 36},
    {"nome": "Produto 57", "preco": 871.29, "quantidade_estoque": 63},
    {"nome": "Produto 58", "preco": 338.74, "quantidade_estoque": 83},
    {"nome": "Produto 59", "preco": 537.92, "quantidade_estoque": 66},
    {"nome": "Produto 60", "preco": 672.38, "quantidade_estoque": 50},
    {"nome": "Produto 61", "preco": 489.75, "quantidade_estoque": 22},
    {"nome": "Produto 62", "preco": 249.68, "quantidade_estoque": 71},
    {"nome": "Produto 63", "preco": 701.93, "quantidade_estoque": 13},
    {"nome": "Produto 64", "preco": 893.24, "quantidade_estoque": 55},
    {"nome": "Produto 65", "preco": 187.52, "quantidade_estoque": 31},
    {"nome": "Produto 66", "preco": 556.94, "quantidade_estoque": 90},
    {"nome": "Produto 67", "preco": 478.29, "quantidade_estoque": 9},
    {"nome": "Produto 68", "preco": 329.85, "quantidade_estoque": 75},
    {"nome": "Produto 69", "preco": 697.58, "quantidade_estoque": 61},
    {"nome": "Produto 70", "preco": 875.62, "quantidade_estoque": 39},
    {"nome": "Produto 71", "preco": 215.49, "quantidade_estoque": 58},
    {"nome": "Produto 72", "preco": 982.17, "quantidade_estoque": 26},
    {"nome": "Produto 73", "preco": 592.83, "quantidade_estoque": 97},
    {"nome": "Produto 74", "preco": 764.92, "quantidade_estoque": 20},
    {"nome": "Produto 75", "preco": 415.26, "quantidade_estoque": 38},
    {"nome": "Produto 76", "preco": 378.56, "quantidade_estoque": 44},
    {"nome": "Produto 77", "preco": 509.37, "quantidade_estoque": 77},
    {"nome": "Produto 78", "preco": 622.49, "quantidade_estoque": 1},
    {"nome": "Produto 79", "preco": 347.85, "quantidade_estoque": 53},
    {"nome": "Produto 80", "preco": 275.62, "quantidade_estoque": 98},
    {"nome": "Produto 81", "preco": 725.39, "quantidade_estoque": 33},
    {"nome": "Produto 82", "preco": 881.24, "quantidade_estoque": 59},
    {"nome": "Produto 83", "preco": 453.28, "quantidade_estoque": 16},
    {"nome": "Produto 84", "preco": 896.57, "quantidade_estoque": 82},
    {"nome": "Produto 85", "preco": 521.83, "quantidade_estoque": 24},
    {"nome": "Produto 86", "preco": 197.26, "quantidade_estoque": 7},
    {"nome": "Produto 87", "preco": 869.73, "quantidade_estoque": 54},
    {"nome": "Produto 88", "preco": 631.48, "quantidade_estoque": 74},
    {"nome": "Produto 89", "preco": 293.85, "quantidade_estoque": 32},
    {"nome": "Produto 90", "preco": 745.61, "quantidade_estoque": 94},
    {"nome": "Produto 91", "preco": 509.27, "quantidade_estoque": 28},
    {"nome": "Produto 92", "preco": 882.46, "quantidade_estoque": 91},
    {"nome": "Produto 93", "preco": 636.79, "quantidade_estoque": 5},
    {"nome": "Produto 94", "preco": 458.93, "quantidade_estoque": 89},
    {"nome": "Produto 95", "preco": 134.28, "quantidade_estoque": 4},
    {"nome": "Produto 96", "preco": 789.57, "quantidade_estoque": 65},
    {"nome": "Produto 97", "preco": 592.83, "quantidade_estoque": 27},
    {"nome": "Produto 98", "preco": 362.48, "quantidade_estoque": 50},
    {"nome": "Produto 99", "preco": 908.67, "quantidade_estoque": 85},
    {"nome": "Produto 100", "preco": 247.36, "quantidade_estoque": 36}
])

# Consulta por produtos acima de R$ 300,00

db.produtos.find({preco:{$gt:300}})

# Atualização 'quantidade em estoque'

db.produtos.updateMany(
    {quantidade_estoque: {$lt: 10}},
    {$set: {quantidade_estoque: 50}}
)

db.produtos.updateMany(
    {quantidade_estoque: {$gt:90}},
    {$inc: {quantidade_estoque: -50}}
)

# índices para melhorar o desempenho das consultas

db.produtos.createIndex({ preco: 1})

db.produtos.createIndex({preco:1, quantidade_estoque: 1})

db.produtos.find({preco: 1})

# Agregar valor total em estoque dos produtos

db.produtos.aggregate([
{$group: {
    _id: "$produto",
    total_estoque: {$sum: {$multiply: ["$preco", "$quantidade_estoque"]}}
}}

])









// The prototype form to create a collection:
/* db.createCollection( <name>,
  {
    capped: <boolean>,
    autoIndexId: <boolean>,
    size: <number>,
    max: <number>,
    storageEngine: <document>,
    validator: <document>,
    validationLevel: <string>,
    validationAction: <string>,
    indexOptionDefaults: <document>,
    viewOn: <string>,
    pipeline: <pipeline>,
    collation: <document>,
    writeConcern: <document>,
    timeseries: { // Added in MongoDB 5.0
      timeField: <string>, // required for time series collections
      metaField: <string>,
      granularity: <string>,
      bucketMaxSpanSeconds: <number>, // Added in MongoDB 6.3
      bucketRoundingSeconds: <number>, // Added in MongoDB 6.3
    },
    expireAfterSeconds: <number>,
    clusteredIndex: <document>, // Added in MongoDB 5.3
  }
)*/

// More information on the `createCollection` command can be found at:
// https://www.mongodb.com/docs/manual/reference/method/db.createCollection/
